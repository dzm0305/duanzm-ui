{"remainingRequest":"/Users/duanzhimin/Java/MyWorkspaces/duanzm-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/duanzhimin/Java/MyWorkspaces/duanzm-ui/src/components/TopNav/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/duanzhimin/Java/MyWorkspaces/duanzm-ui/src/components/TopNav/index.vue","mtime":1620714380000},{"path":"/Users/duanzhimin/Java/MyWorkspaces/duanzm-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/duanzhimin/Java/MyWorkspaces/duanzm-ui/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/duanzhimin/Java/MyWorkspaces/duanzm-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/duanzhimin/Java/MyWorkspaces/duanzm-ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGNvbnN0YW50Um91dGVzIH0gZnJvbSAiQC9yb3V0ZXIiOwoKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICAvLyDpobbpg6jmoI/liJ3lp4vmlbAKICAgICAgdmlzaWJsZU51bWJlcjogNSwKICAgICAgLy8g5piv5ZCm5Li66aaW5qyh5Yqg6L29CiAgICAgIGlzRnJpc3Q6IGZhbHNlLAogICAgICAvLyDlvZPliY3mv4DmtLvoj5zljZXnmoQgaW5kZXgKICAgICAgY3VycmVudEluZGV4OiB1bmRlZmluZWQKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgdGhlbWUoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5zZXR0aW5ncy50aGVtZTsKICAgIH0sCiAgICAvLyDpobbpg6jmmL7npLroj5zljZUKICAgIHRvcE1lbnVzKCkgewogICAgICBsZXQgdG9wTWVudXMgPSBbXTsKICAgICAgdGhpcy5yb3V0ZXJzLm1hcCgobWVudSkgPT4gewogICAgICAgIGlmIChtZW51LmhpZGRlbiAhPT0gdHJ1ZSkgewogICAgICAgICAgLy8g5YW85a656aG26YOo5qCP5LiA57qn6I+c5Y2V5YaF6YOo6Lez6L2sCiAgICAgICAgICBpZiAobWVudS5wYXRoID09PSAiLyIpIHsKICAgICAgICAgICAgICB0b3BNZW51cy5wdXNoKG1lbnUuY2hpbGRyZW5bMF0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0b3BNZW51cy5wdXNoKG1lbnUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiB0b3BNZW51czsKICAgIH0sCiAgICAvLyDmiYDmnInnmoTot6/nlLHkv6Hmga8KICAgIHJvdXRlcnMoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5wZXJtaXNzaW9uLnRvcGJhclJvdXRlcnM7CiAgICB9LAogICAgLy8g6K6+572u5a2Q6Lev55SxCiAgICBjaGlsZHJlbk1lbnVzKCkgewogICAgICB2YXIgY2hpbGRyZW5NZW51cyA9IFtdOwogICAgICB0aGlzLnJvdXRlcnMubWFwKChyb3V0ZXIpID0+IHsKICAgICAgICBmb3IgKHZhciBpdGVtIGluIHJvdXRlci5jaGlsZHJlbikgewogICAgICAgICAgaWYgKHJvdXRlci5jaGlsZHJlbltpdGVtXS5wYXJlbnRQYXRoID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgaWYocm91dGVyLnBhdGggPT09ICIvIikgewogICAgICAgICAgICAgIHJvdXRlci5jaGlsZHJlbltpdGVtXS5wYXRoID0gIi9yZWRpcmVjdC8iICsgcm91dGVyLmNoaWxkcmVuW2l0ZW1dLnBhdGg7CiAgICAgICAgICAgIH0gZWxzZSB7CgkJCSAgaWYoIXRoaXMuaXNodHRwKHJvdXRlci5jaGlsZHJlbltpdGVtXS5wYXRoKSkgewogICAgICAgICAgICAgICAgcm91dGVyLmNoaWxkcmVuW2l0ZW1dLnBhdGggPSByb3V0ZXIucGF0aCArICIvIiArIHJvdXRlci5jaGlsZHJlbltpdGVtXS5wYXRoOwoJCQkgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByb3V0ZXIuY2hpbGRyZW5baXRlbV0ucGFyZW50UGF0aCA9IHJvdXRlci5wYXRoOwogICAgICAgICAgfQogICAgICAgICAgY2hpbGRyZW5NZW51cy5wdXNoKHJvdXRlci5jaGlsZHJlbltpdGVtXSk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuIGNvbnN0YW50Um91dGVzLmNvbmNhdChjaGlsZHJlbk1lbnVzKTsKICAgIH0sCiAgICAvLyDpu5jorqTmv4DmtLvnmoToj5zljZUKICAgIGFjdGl2ZU1lbnUoKSB7CiAgICAgIGNvbnN0IHBhdGggPSB0aGlzLiRyb3V0ZS5wYXRoOwogICAgICBsZXQgYWN0aXZlUGF0aCA9IHRoaXMucm91dGVyc1swXS5wYXRoOwogICAgICBpZiAocGF0aC5sYXN0SW5kZXhPZigiLyIpID4gMCkgewogICAgICAgIGNvbnN0IHRtcFBhdGggPSBwYXRoLnN1YnN0cmluZygxLCBwYXRoLmxlbmd0aCk7CiAgICAgICAgYWN0aXZlUGF0aCA9ICIvIiArIHRtcFBhdGguc3Vic3RyaW5nKDAsIHRtcFBhdGguaW5kZXhPZigiLyIpKTsKICAgICAgfSBlbHNlIGlmICgiL2luZGV4IiA9PSBwYXRoIHx8ICIiID09IHBhdGgpIHsKICAgICAgICBpZiAoIXRoaXMuaXNGcmlzdCkgewogICAgICAgICAgdGhpcy5pc0ZyaXN0ID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYWN0aXZlUGF0aCA9ICJpbmRleCI7CiAgICAgICAgfQogICAgICB9CiAgICAgIHZhciByb3V0ZXMgPSB0aGlzLmFjdGl2ZVJvdXRlcyhhY3RpdmVQYXRoKTsKICAgICAgaWYgKHJvdXRlcy5sZW5ndGggPT09IDApIHsKICAgICAgICBhY3RpdmVQYXRoID0gdGhpcy5jdXJyZW50SW5kZXggfHwgdGhpcy5yb3V0ZXJzWzBdLnBhdGgKICAgICAgICB0aGlzLmFjdGl2ZVJvdXRlcyhhY3RpdmVQYXRoKTsKICAgICAgfQogICAgICByZXR1cm4gYWN0aXZlUGF0aDsKICAgIH0sCiAgfSwKICBiZWZvcmVNb3VudCgpIHsKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnNldFZpc2libGVOdW1iZXIpCiAgfSwKICBiZWZvcmVEZXN0cm95KCkgewogICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuc2V0VmlzaWJsZU51bWJlcikKICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLnNldFZpc2libGVOdW1iZXIoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOagueaNruWuveW6puiuoeeul+iuvue9ruaYvuekuuagj+aVsAogICAgc2V0VmlzaWJsZU51bWJlcigpIHsKICAgICAgY29uc3Qgd2lkdGggPSBkb2N1bWVudC5ib2R5LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoIC8gMzsKICAgICAgdGhpcy52aXNpYmxlTnVtYmVyID0gcGFyc2VJbnQod2lkdGggLyA4NSk7CiAgICB9LAogICAgLy8g6I+c5Y2V6YCJ5oup5LqL5Lu2CiAgICBoYW5kbGVTZWxlY3Qoa2V5LCBrZXlQYXRoKSB7CiAgICAgIHRoaXMuY3VycmVudEluZGV4ID0ga2V5OwogICAgICBpZiAodGhpcy5pc2h0dHAoa2V5KSkgewogICAgICAgIC8vIGh0dHAocyk6Ly8g6Lev5b6E5paw56qX5Y+j5omT5byACiAgICAgICAgd2luZG93Lm9wZW4oa2V5LCAiX2JsYW5rIik7CiAgICAgIH0gZWxzZSBpZiAoa2V5LmluZGV4T2YoIi9yZWRpcmVjdCIpICE9PSAtMSkgewogICAgICAgIC8vIC9yZWRpcmVjdCDot6/lvoTlhoXpg6jmiZPlvIAKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IHBhdGg6IGtleS5yZXBsYWNlKCIvcmVkaXJlY3QiLCAiIikgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8g5pi+56S65bem5L6n6IGU5Yqo6I+c5Y2VCiAgICAgICAgdGhpcy5hY3RpdmVSb3V0ZXMoa2V5KTsKICAgICAgfQogICAgfSwKICAgIC8vIOW9k+WJjea/gOa0u+eahOi3r+eUsQogICAgYWN0aXZlUm91dGVzKGtleSkgewogICAgICB2YXIgcm91dGVzID0gW107CiAgICAgIGlmICh0aGlzLmNoaWxkcmVuTWVudXMgJiYgdGhpcy5jaGlsZHJlbk1lbnVzLmxlbmd0aCA+IDApIHsKICAgICAgICB0aGlzLmNoaWxkcmVuTWVudXMubWFwKChpdGVtKSA9PiB7CiAgICAgICAgICBpZiAoa2V5ID09IGl0ZW0ucGFyZW50UGF0aCB8fCAoa2V5ID09ICJpbmRleCIgJiYgIiIgPT0gaXRlbS5wYXRoKSkgewogICAgICAgICAgICByb3V0ZXMucHVzaChpdGVtKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgICBpZihyb3V0ZXMubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgiU0VUX1NJREVCQVJfUk9VVEVSUyIsIHJvdXRlcyk7CiAgICAgIH0KICAgICAgcmV0dXJuIHJvdXRlczsKICAgIH0sCglpc2h0dHAodXJsKSB7CiAgICAgIHJldHVybiB1cmwuaW5kZXhPZignaHR0cDovLycpICE9PSAtMSB8fCB1cmwuaW5kZXhPZignaHR0cHM6Ly8nKSAhPT0gLTEKICAgIH0KICB9LAp9Owo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/TopNav","sourcesContent":["<template>\n  <el-menu\n    :default-active=\"activeMenu\"\n    mode=\"horizontal\"\n    @select=\"handleSelect\"\n  >\n    <template v-for=\"(item, index) in topMenus\">\n      <el-menu-item :style=\"{'--theme': theme}\" :index=\"item.path\" :key=\"index\" v-if=\"index < visibleNumber\"\n        ><svg-icon :icon-class=\"item.meta.icon\" />\n        {{ item.meta.title }}</el-menu-item\n      >\n    </template>\n\n    <!-- 顶部菜单超出数量折叠 -->\n    <el-submenu index=\"more\" v-if=\"topMenus.length > visibleNumber\">\n      <template slot=\"title\">更多菜单</template>\n      <template v-for=\"(item, index) in topMenus\">\n        <el-menu-item\n          :index=\"item.path\"\n          :key=\"index\"\n          v-if=\"index >= visibleNumber\"\n          ><svg-icon :icon-class=\"item.meta.icon\" />\n          {{ item.meta.title }}</el-menu-item\n        >\n      </template>\n    </el-submenu>\n  </el-menu>\n</template>\n\n<script>\nimport { constantRoutes } from \"@/router\";\n\nexport default {\n  data() {\n    return {\n      // 顶部栏初始数\n      visibleNumber: 5,\n      // 是否为首次加载\n      isFrist: false,\n      // 当前激活菜单的 index\n      currentIndex: undefined\n    };\n  },\n  computed: {\n    theme() {\n      return this.$store.state.settings.theme;\n    },\n    // 顶部显示菜单\n    topMenus() {\n      let topMenus = [];\n      this.routers.map((menu) => {\n        if (menu.hidden !== true) {\n          // 兼容顶部栏一级菜单内部跳转\n          if (menu.path === \"/\") {\n              topMenus.push(menu.children[0]);\n          } else {\n              topMenus.push(menu);\n          }\n        }\n      });\n      return topMenus;\n    },\n    // 所有的路由信息\n    routers() {\n      return this.$store.state.permission.topbarRouters;\n    },\n    // 设置子路由\n    childrenMenus() {\n      var childrenMenus = [];\n      this.routers.map((router) => {\n        for (var item in router.children) {\n          if (router.children[item].parentPath === undefined) {\n            if(router.path === \"/\") {\n              router.children[item].path = \"/redirect/\" + router.children[item].path;\n            } else {\n\t\t\t  if(!this.ishttp(router.children[item].path)) {\n                router.children[item].path = router.path + \"/\" + router.children[item].path;\n\t\t\t  }\n            }\n            router.children[item].parentPath = router.path;\n          }\n          childrenMenus.push(router.children[item]);\n        }\n      });\n      return constantRoutes.concat(childrenMenus);\n    },\n    // 默认激活的菜单\n    activeMenu() {\n      const path = this.$route.path;\n      let activePath = this.routers[0].path;\n      if (path.lastIndexOf(\"/\") > 0) {\n        const tmpPath = path.substring(1, path.length);\n        activePath = \"/\" + tmpPath.substring(0, tmpPath.indexOf(\"/\"));\n      } else if (\"/index\" == path || \"\" == path) {\n        if (!this.isFrist) {\n          this.isFrist = true;\n        } else {\n          activePath = \"index\";\n        }\n      }\n      var routes = this.activeRoutes(activePath);\n      if (routes.length === 0) {\n        activePath = this.currentIndex || this.routers[0].path\n        this.activeRoutes(activePath);\n      }\n      return activePath;\n    },\n  },\n  beforeMount() {\n    window.addEventListener('resize', this.setVisibleNumber)\n  },\n  beforeDestroy() {\n    window.removeEventListener('resize', this.setVisibleNumber)\n  },\n  mounted() {\n    this.setVisibleNumber();\n  },\n  methods: {\n    // 根据宽度计算设置显示栏数\n    setVisibleNumber() {\n      const width = document.body.getBoundingClientRect().width / 3;\n      this.visibleNumber = parseInt(width / 85);\n    },\n    // 菜单选择事件\n    handleSelect(key, keyPath) {\n      this.currentIndex = key;\n      if (this.ishttp(key)) {\n        // http(s):// 路径新窗口打开\n        window.open(key, \"_blank\");\n      } else if (key.indexOf(\"/redirect\") !== -1) {\n        // /redirect 路径内部打开\n        this.$router.push({ path: key.replace(\"/redirect\", \"\") });\n      } else {\n        // 显示左侧联动菜单\n        this.activeRoutes(key);\n      }\n    },\n    // 当前激活的路由\n    activeRoutes(key) {\n      var routes = [];\n      if (this.childrenMenus && this.childrenMenus.length > 0) {\n        this.childrenMenus.map((item) => {\n          if (key == item.parentPath || (key == \"index\" && \"\" == item.path)) {\n            routes.push(item);\n          }\n        });\n      }\n      if(routes.length > 0) {\n        this.$store.commit(\"SET_SIDEBAR_ROUTERS\", routes);\n      }\n      return routes;\n    },\n\tishttp(url) {\n      return url.indexOf('http://') !== -1 || url.indexOf('https://') !== -1\n    }\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.el-menu--horizontal > .el-menu-item {\n  float: left;\n  height: 50px;\n  line-height: 50px;\n  margin: 0;\n  border-bottom: 3px solid transparent;\n  color: #999093;\n  padding: 0 5px;\n  margin: 0 10px;\n}\n\n.el-menu--horizontal > .el-menu-item.is-active {\n  border-bottom: 3px solid #{'var(--theme)'};\n  color: #303133;\n}\n\n/* submenu item */\n.el-menu--horizontal > .el-submenu .el-submenu__title {\n\theight: 50px !important;\n\tline-height: 50px !important;\n}\n</style>\n"]}]}